{% extends "post_login_accounts.html" %}
{% block content %}

<div style="display: flex; flex-direction: column;align-items: center;">
        <div>
            Enter Dates and necessary Information Below to get Account Statements
        </div>
        <div>
            <label for="startDate">Start Date</label>
            <input type="date" id="startDate" name="startDate">
        </div>

        <div>
            <label for="endDate">End Date</label>
            <input type="date" id="endDate" name="endDate">
        </div>

        <div style="display: flex; align-items: center; justify-content: center; flex-direction: row;">
            <div class="form-group" style="display: block; width: 38%">
                <label style="flex: 8" for="ledger">Ledger</label>
                <select style="flex: 4" class="form-control" id="ledger" name="ledger">
                    {% set nature = ['Sub', 'Main'] %}

                    {% for nat in nature %}
                        <option value= "{{nat}}">{{nat}}</option>"
                    {% endfor %}
                </select>
            </div>
            <div class="form-group" style="display: block; width: 38%">
                <label style="flex: 8" for="adjustmentVoucher">Adjustment Voucher</label>
                <select style="flex: 4" class="form-control" id="adjustmentVoucher" name="adjustmentVoucher">
                    {% set nature = ['No', 'Yes'] %}

                    {% for nat in nature %}
                        <option value= "{{nat}}">{{nat}}</option>"
                    {% endfor %}
                </select>
            </div>
            <div class="form-group" style="display: block; width: 38%">
                <label style="flex: 4" for="accountHead">Account Head</label>
                <select style="flex: 4" class="form-control" id="accountHead" name="accountHead">
                {% set nature = ['ADVANCE TO TUCS LTD.', 'ADVANCE-NEW CATHEDRAL SERVICE STATION', 'ADVANCES', 'AMOUNT DUE FROM CTA', 'AMOUNT PAYABLE TO TAMCO (CAR)', 'AMOUNT RECEIVABLE FROM ELCOT', 'AMOUNT RECEIVABLE FROM NBCFDC', 'AMOUNT RECEIVED FROM GOVT (IRRI)', 'AMOUNT TRANSFERRED TO TAMCO', 'AMT REC FROM NBCFDC FOR EXHIBITION', 'AMT REVD FROM GOVT - JOT (PD A/c)', 'ARREARS PAYABLE', 'BAD AND DOUBTFUL DEBTS', 'BANK CHARGES', 'BANK OF BARODA , MOUNT ROAD BR', 'BOARD MEETING EXPENSE', 'BONUS', 'BOOKS & PERIODICALS', 'Buildings', 'CANCELLATION OF CHEQUE(JOT)', 'COMM OF BACKWARD CLASSES', 'COMPUTER TRAINING', 'COMPUTERS', 'CONTRIBUTION TO EPF & OTHER FUNDS', 'CONVEYANCE CHARGES', 'COST OF FUEL', 'DCCB INT', 'DCCB P.INT', 'DEPRECIATION', 'EDP INTEREST', 'EDP P INT.', 'ELECTRICITY CHARGES', 'EXHIBITION/ADVERTISEMENT EXEPNSES', 'FESTIVAL ADVANCE', 'FILING FEES', 'FIXED DEPOSIT', 'FURNITURE & FITTINGS', 'GRATUITY', 'Gain on sale of assets', 'GROUP INSURANCE SCHEME', 'GUARANTEE COMMISSIN PAYABLE TO TN GOVT', 'GUARANTEE COMMISSION TO T.N. GOVT.', 'Indian Bank T.Nagar Branch', 'INDUSIND BANK, NUNGABAKKAM BR', 'INSURANCE', 'INTEREST ACCRUED ON FD', 'INTEREST ACCRUED ON ML LOAN', 'INTEREST ACCRUED ON SB A/C', 'INTEREST ACCURED BUT NOT DUE ON FD', 'INTEREST FROM TAMCO receivable', 'INTEREST ON FIXED DEPOSIT', 'INTEREST ON SAVING BANK A/C', 'INTEREST PAID TO NBCFDC', 'INTERIM ARREARS', 'INTERNAL AUDIT FEES PAYABLE', 'STATUTORY AUDIT FEES PAYABLE', 'INTEREST ON ML LOAN', 'INTERIM ARREARS', 'INTERNAL AUDIT FEES', 'IOB, MOUNT ROAD', 'ISSUED, SUBSCRIBED AND PAID-UP', 'Karur Vysya Bank Kodambakkam branch', 'LEAVE SALARY', 'LEGAL FEES', 'LOAN FOR SETTING UP OF MOBILE LAUNDRY', 'LOAN FROM NBCFDC (GTL)', 'LOAN FROM NBCFDC (MCS)', 'LOAN FROM NBCFDC (MSY)', 'LOAN HOSTEL -PRINCIPAL', 'LOAN TO AAVIN-PRINCIPAL', 'LOAN TO DCCB (GTL) - PRINCIPAL', 'LOAN TO EDP TRAINED WOMEN - PRINCIPAL', 'LOAN TO HDC-PRINCIPAL', 'LOAN TO ICS (AUTO)-PRINCIPAL (BC)', 'LOAN TO ICS (AUTO)-PRINCIPAL (G)', 'LOAN TO ICS (AUTO)-PRINCIPAL (M)', 'LOAN TO ICS (MML) PRINCIPAL', 'LOAN TO MICRO CREDIT SCHEME-PRINCIPAL', 'LOAN TO NSS -PRINCIPAL', 'LOAN TO PACB (GTL) - PRINCIPAL', 'LOAN TO SUGAR MILL-PRINCIPAL', 'LOAN TO TAICO-PRINCIPAL', 'LOAN TO UCB (GTL) -PRINCIPAL', 'MARGIN ON INTEREST PAYABLE TO SCAS (SC)', 'MAS INT.', 'MAS P.INT', 'MEDICAL EXPENSES', ' MEETING EXPENSE', 'MICRO CREDIT SCHEME INT', 'MICRO CREDIT SCHEME P.INT', 'MLL INT.', 'MLL P.INT', 'MOTOR CAR', 'NEW HEALTH INSURANCE SCHEME', 'NSS INTEREST', 'NSS P.INTEREST', 'OFFICE EQUIPMENT', 'OFFICE EXPENSE', 'OUTSTANDING EXPENSES', 'P.D. A/C - RBI', 'PACB INT', 'PACB P.INT', 'PENAL INTEREST ACCRUED', 'PENSION CONTRIBUTION', 'PETTY CASH', 'POSTAGE EXPENSES', 'PRINTING AND STATIONERY', 'PROFEESIONAL FEES', 'PROFIT AND LOSS ACCOUNT', 'PROVISION FOR BAD & DOUDTFUL DEBTIS', 'PROVISION FOR BONUS', 'PROVISION FOR GRATUITY', 'PROVISION FOR LEAVE SALARY', 'Purchase of Telephone', 'REFRESHMENT CHARGES', 'REMUNERATION TO CHARMAN', 'RENT', 'REPAIR & MAINTENANCE', 'SALARIES', 'Sale of Tender Form', 'SERVICE CHARGES', 'SOFTWARE DEVELOPMENT ', 'STAMPS ON HAND', 'STATUTORY AUDIT FEES', 'STIPEND', 'SUBSIDY CHARGES RECEIVABLE FROM GOVT.', 'SUBSIDY RECEIVED FROM GOVT FOR ML', 'SYNDICATE BANK, EGMORE BR', 'TAICO INT', 'TAMCO', 'TAMILNADU STATE APEX CO-OP BANK', 'TAX AUDIT FEES', 'TDS ON BANK DEPOSITS', 'TDS ON RENT', 'TELEPHONE DEPOSIT', 'TELEPHONE CHARGES', 'TRAINING GRANT IN AID FROM NBCFDC', 'TRAVELLING EXPENSE/TTA', 'UCB INT', 'UCB P.INT', 'VEHICLE HIRE CHARGES', 'VEHICLE MAINTANCE', 'WORK IN PROGRESS', 'WAGES'] %}

                {% for nat in nature %}
                <option value= "{{nat}}">{{nat}}</option>"
                {% endfor %}
                </select>
            </div>
            <div class="form-group" style="display: block; width: 38%">
                <label style="flex: 8" for="natureOfTransaction">Transaction Type</label>
                <select style="flex: 4" class="form-control" id="natureOfTransaction" name="natureOfTransaction">
                    {% set nature = ['Debit', 'Credit'] %}

                    {% for nat in nature %}
                        <option value= "{{nat}}">{{nat}}</option>"
                    {% endfor %}
                </select>
            </div>
        </div>

        <div style="display: flex; justify-content: space-between; flex-direction: row;">
            <button class="btn btn-success" onclick="downloadLS()">Ledger Statement</button>
            <button class="btn btn-success" onclick="downloadAHS()">HOA Statement</button>
            <button class="btn btn-success" onclick="downloadAVS()">Adjustment Voucher Statement</button>
            <button class="btn btn-success" onclick="downloadLAHS()">Ledger HOA Statements</button>
            <button class="btn btn-success" onclick="downloadCDS()">Credit/Debit Statements</button>
            <button class="btn btn-success" onclick="downloadICL()">Int CheckList</button>
        </div>
</div>

<script>
    function downloadLS() {
        var ledger = document.getElementById('ledger').value;
        var start_date = document.getElementById('startDate').value;
        var end_date = document.getElementById('endDate').value;
        var doc = new jsPDF('l', 'mm', [297, 210]);

    var source = "/accounts_between_ledger/"+start_date+"/"+end_date+"/"+ledger;
    $.ajax({
        type: 'GET',
        url: source,
        contentType: "application/json",
        dataType: 'json',
        success: function (json) {

            doc.setFontSize(10);

            doc.text(80, 20, "Tamil Nadu Backward Classes Economic Development Corporation");
            doc.text(90, 30, "Ledger Book for "+start_date+" to "+end_date+" for "+ledger);

            columns = ["Voucher #", "Voucher Date",  "Cheque/DD #", "Cheque Date", "Account Head", "Amount", "Transaction"];
            rows = [];

            for(var i=0; i<json.length; i++) {
                rows.push([[json[i]["payment_voucher"]], [moment(json[i]['invoice_date']['$date']).format('YYYY-MM-DD')],
                    [json[i]["cheque_number"]], [moment(json[i]['cheque_date']['$date']).format('YYYY-MM-DD')],
                    [json[i]["account_head"]], [json[i]["amount"]], [json[i]["nature_of_transaction"]]]);
            }

            doc.autoTable(columns, rows, {startY: 40});

            doc.save('LedgerBook'+start_date+'to'+end_date+'.pdf')
        },
        error: function (e) {
            alert("error");
        }
    });
    }

    function downloadAHS() {
        var ledger = document.getElementById('accountHead').value;
        var start_date = document.getElementById('startDate').value;
        var end_date = document.getElementById('endDate').value;
        var doc = new jsPDF('l', 'mm', [297, 210]);

    var source = "/accounts_between_HOA/"+start_date+"/"+end_date+"/"+ledger;
    $.ajax({
        type: 'GET',
        url: source,
        contentType: "application/json",
        dataType: 'json',
        success: function (json) {

            doc.setFontSize(10);

            doc.text(80, 20, "Tamil Nadu Backward Classes Economic Development Corporation");
            doc.text(90, 30, "Ledger Book for "+start_date+" to "+end_date+" for "+ledger);

            columns = ["Voucher #", "Voucher Date",  "Cheque/DD #", "Cheque Date", "Account Head", "Amount", "Transaction"];
            rows = [];

            for(var i=0; i<json.length; i++) {
                rows.push([[json[i]["payment_voucher"]], [moment(json[i]['invoice_date']['$date']).format('YYYY-MM-DD')],
                    [json[i]["cheque_number"]], [moment(json[i]['cheque_date']['$date']).format('YYYY-MM-DD')],
                    [json[i]["account_head"]], [json[i]["amount"]], [json[i]["nature_of_transaction"]]]);
            }

            doc.autoTable(columns, rows, {startY: 40});

            doc.save('HOABook'+start_date+'to'+end_date+'.pdf')
        },
        error: function (e) {
            alert("error");
        }
    });
    }

    function downloadAVS() {
        var ledger = document.getElementById('adjustmentVoucher').value;
        var start_date = document.getElementById('startDate').value;
        var end_date = document.getElementById('endDate').value;
        var doc = new jsPDF('l', 'mm', [297, 210]);

    var source = "/accounts_between_adjustmentVoucher/"+start_date+"/"+end_date+"/"+ledger;
    $.ajax({
        type: 'GET',
        url: source,
        contentType: "application/json",
        dataType: 'json',
        success: function (json) {

            doc.setFontSize(10);

            doc.text(80, 20, "Tamil Nadu Backward Classes Economic Development Corporation");
            doc.text(90, 30, "Ledger Book for "+start_date+" to "+end_date+" for "+ledger);

            columns = ["Voucher #", "Voucher Date",  "Cheque/DD #", "Cheque Date", "Account Head", "Amount", "Transaction"];
            rows = [];

            for(var i=0; i<json.length; i++) {
                rows.push([[json[i]["payment_voucher"]], [moment(json[i]['invoice_date']['$date']).format('YYYY-MM-DD')],
                    [json[i]["cheque_number"]], [moment(json[i]['cheque_date']['$date']).format('YYYY-MM-DD')],
                    [json[i]["account_head"]], [json[i]["amount"]], [json[i]["nature_of_transaction"]]]);
            }

            doc.autoTable(columns, rows, {startY: 40});

            doc.save('AdjustmentVoucherBook'+start_date+'to'+end_date+'.pdf')
        },
        error: function (e) {
            alert("error");
        }
    });
    }

    function downloadLAHS() {
        var ledger = document.getElementById('ledger').value;
        var HOA = document.getElementById('accountHead').value;
        var start_date = document.getElementById('startDate').value;
        var end_date = document.getElementById('endDate').value;
        var doc = new jsPDF('l', 'mm', [297, 210]);

    var source = "/accounts_between_ledger_accHead/"+start_date+"/"+end_date+"/"+ledger+"/"+HOA;
    $.ajax({
        type: 'GET',
        url: source,
        contentType: "application/json",
        dataType: 'json',
        success: function (json) {

            doc.setFontSize(10);

            doc.text(80, 20, "Tamil Nadu Backward Classes Economic Development Corporation");
            doc.text(90, 30, "Ledger Book between "+start_date+" to "+end_date+" for "+ledger+" in "+HOA);

            columns = ["Voucher #", "Voucher Date",  "Cheque/DD #", "Cheque Date", "Account Head", "Amount", "Transaction"];
            rows = [];

            for(var i=0; i<json.length; i++) {
                rows.push([[json[i]["payment_voucher"]], [moment(json[i]['invoice_date']['$date']).format('YYYY-MM-DD')],
                    [json[i]["cheque_number"]], [moment(json[i]['cheque_date']['$date']).format('YYYY-MM-DD')],
                    [json[i]["account_head"]], [json[i]["amount"]], [json[i]["nature_of_transaction"]]]);
            }

            doc.autoTable(columns, rows, {startY: 40});

            doc.save('LedgerHOABook'+start_date+'to'+end_date+'.pdf')
        },
        error: function (e) {
            alert("error");
        }
    });
    }

    function downloadCDS() {
        var ledger = document.getElementById('natureOfTransaction').value;
        var start_date = document.getElementById('startDate').value;
        var end_date = document.getElementById('endDate').value;
        var doc = new jsPDF('l', 'mm', [297, 210]);

    var source = "/accounts_between_cds/"+start_date+"/"+end_date+"/"+ledger;
    $.ajax({
        type: 'GET',
        url: source,
        contentType: "application/json",
        dataType: 'json',
        success: function (json) {

            doc.setFontSize(10);

            doc.text(80, 20, "Tamil Nadu Backward Classes Economic Development Corporation");
            doc.text(90, 30, "Ledger Book between "+start_date+" to "+end_date+" for "+ledger);

            columns = ["Voucher #", "Voucher Date",  "Cheque/DD #", "Cheque Date", "Account Head", "Amount", "Transaction"];
            rows = [];

            for(var i=0; i<json.length; i++) {
                rows.push([[json[i]["payment_voucher"]], [moment(json[i]['invoice_date']['$date']).format('YYYY-MM-DD')],
                    [json[i]["cheque_number"]], [moment(json[i]['cheque_date']['$date']).format('YYYY-MM-DD')],
                    [json[i]["account_head"]], [json[i]["amount"]], [json[i]["nature_of_transaction"]]]);
            }

            doc.autoTable(columns, rows, {startY: 40});

            doc.save('CreditDebitBook'+start_date+'to'+end_date+'.pdf')
        },
        error: function (e) {
            alert("error");
        }
    });
    }

    function downloadICL() {
        var ledger = "Credit";
        var start_date = document.getElementById('startDate').value;
        var end_date = document.getElementById('endDate').value;
        var doc = new jsPDF('l', 'mm', [297, 210]);

    var source = "/accounts_between_cds/"+start_date+"/"+end_date+"/"+ledger;
    $.ajax({
        type: 'GET',
        url: source,
        contentType: "application/json",
        dataType: 'json',
        success: function (json) {

            doc.setFontSize(10);

            doc.text(80, 20, "Tamil Nadu Backward Classes Economic Development Corporation");
            doc.text(90, 30, "Interest Checklist from "+start_date+" to "+end_date);

            columns = ["Voucher #", "Voucher Date", "Bank Name", "Cheque/DD #", "Cheque Date", "Principal", "Interest",
                "Penal Interest", "Service Charge", "Total Amount"];
            rows = [];

            for(var i=0; i<json.length; i++) {
                if(json[i]['principal']) {
                rows.push([[json[i]["payment_voucher"]], [moment(json[i]['voucher_date']['$date']).format('YYYY-MM-DD')],
                    [json[i]["external_bank_account"]], [json[i]["cheque_number"]], [moment(json[i]['cheque_date']['$date']).format('YYYY-MM-DD')],
                    [''], [json[i]["interest"].toFixed(1)], [json[i]["penal_interest"].toFixed(1)], [json[i]["service_charge"].toFixed(1)],
                    [parseInt(json[i]["service_charge"])+parseInt(json[i]["penal_interest"])+parseInt(json[i]["interest"])]]);
                }
            }

            doc.autoTable(columns, rows, {startY: 40});

            doc.save('BankCheckList'+start_date+'to'+end_date+'.pdf')
        },
        error: function (e) {
            alert("error");
        }
    });
    }
</script>

{% endblock %}
